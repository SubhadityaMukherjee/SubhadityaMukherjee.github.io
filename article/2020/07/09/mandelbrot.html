<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">

</script>

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Mandelbrot set | Deconstructing Deep learning</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Mandelbrot set" />
<meta name="author" content="Subhaditya Mukherjee" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Have you heard of fractal patterns? Here we will try to make some :) (look at the pictures at the end)" />
<meta property="og:description" content="Have you heard of fractal patterns? Here we will try to make some :) (look at the pictures at the end)" />
<meta property="og:site_name" content="Deconstructing Deep learning" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-09T12:51:12+00:00" />
<script type="application/ld+json">
{"description":"Have you heard of fractal patterns? Here we will try to make some :) (look at the pictures at the end)","url":"/article/2020/07/09/mandelbrot.html","@type":"BlogPosting","headline":"Mandelbrot set","dateModified":"2020-07-09T12:51:12+00:00","datePublished":"2020-07-09T12:51:12+00:00","author":{"@type":"Person","name":"Subhaditya Mukherjee"},"mainEntityOfPage":{"@type":"WebPage","@id":"/article/2020/07/09/mandelbrot.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="stylesheet" href="/assets/css/landing.css?v=">
  </head>
  <body>
    <div class="col-md-4">
      <header>
        <h2><a id = "imp" href="/">Home page</a></h2>
        <p>Deconstructing Deep Learning +  δeviations</p>
        
        <p>
          Drop me an <a href = "mailto: msubhaditya@gmail.com">email</a>
          | RSS feed link : <a href ="https://subhadityamukherjee.github.io/feed.xml">Click</a> <br>
          Format : 
          Date | Title<br>
          &emsp;&emsp;TL; DR<br>
          <h4>Total number of posts : 88</h4>
         Go To : <a style="font-size:20px;color:white;" href="#PAPER">PAPERS</a> o
        <a style="font-size:20px;color:white;" href="#ARTICLE">ARTICLES</a> o
        <a style="font-size:20px;color:white;" href="#BOOK">BOOKS</a> o
        <a style="font-size:20px;color:white;" href="#SPACE">SPACE</a>
         
        </p>
        
        <p class="view">
        <a href="https://www.github.com/SubhadityaMukherjee">View My GitHub Profile </a>
        </p>
      </header>
      
      <hr>
    </div>
<section>
      <div class="col-md-5">
  <a href = "/deeplearning.html">Go to index</a><br><br>


<h1>Mandelbrot set</h1>

<span class="reading-time" title="Estimated read time">
  
  
    <h3>Reading time : ~10 mins</h3>
  
</span>


<p class="view">by Subhaditya Mukherjee</p>
<ul>
  <li><a href="#what-we-want">What we want</a></li>
  <li><a href="#coding-what-we-want">Coding what we want</a></li>
  <li><a href="#outputs">Outputs</a></li>
</ul>

<p>Have you heard of fractal patterns? Here we will try to make some :) (look at the pictures at the end)</p>

<p>A mandelbrot set is obtained from the recurrence relation \(Z_{n} = Z^2_{n-1} + c\) where \(Z_{0}\) is a complex number.
Note : Most of the code is from a python source which I converted to Julia <a href="https://levelup.gitconnected.com/mandelbrot-set-with-python-983e9fc47f56">Link</a></p>

<p>Okay lets get to it.</p>

<h2 id="what-we-want">What we want</h2>

<p>We take complex numbers
See if they diverge to infinity
Or converge to 0 (over a fixed number of iterations and not infinity because well inifnity is too far away xD)
At every point, provide a color if the condition is satisfied
Since I am really bored, let us add multiple conditions based on randomness.</p>

<h2 id="coding-what-we-want">Coding what we want</h2>

<p>Let us load the one package we need for this.</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">Plots</span>
</code></pre></div></div>

<p>First to find out if the number diverges and how many steps it takes to do so. (Given a constraint)</p>

<p>Let us create a backup of our complex number, and give it a max steps. Since we cannot check for infinity, let us also define a threshold to check if the number is diverging till there or not.</p>

<p>Now Julia handles complex numbers a bit differently so to work the python way, we need to hack it a bit and add the two halves that Julia stores it as. We also do that for c because the clone z does not affect c.
Now as long as we do not exceed the maximum steps we have defined, we check for the breaking condition</p>

\[\left( \mathrm{real}\left( z \cdot \mathrm{conj}\left( z \right) \right) \lt threshold \right)\]

<p>If this is also satisfied, we basically keep doing  \(z = z \cdot z + c\) until the condition is not met and keep incrementing i. When the loop ends, we have the count of the number of steps it took and that is our i which we return.</p>

<blockquote>
  <p>I really love the @show . It gives an output like z = “some val” y = “some val” which makes it really easy to debug. Even @info is really cool</p>
</blockquote>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> get_iter</span><span class="x">(</span><span class="n">c</span><span class="x">,</span><span class="n">thresh</span><span class="o">=</span><span class="mi">4</span><span class="x">,</span> <span class="n">max_steps</span> <span class="o">=</span> <span class="mi">25</span><span class="x">)</span>
    <span class="n">z</span><span class="x">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">c</span><span class="x">,</span> <span class="mi">1</span>
    
    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">z</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span><span class="nb">im</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span><span class="o">+</span><span class="n">c</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span><span class="nb">im</span>
    <span class="n">conz</span> <span class="o">=</span> <span class="n">conj</span><span class="x">(</span><span class="n">z</span><span class="x">)</span>
    <span class="c">#@show z, conj.(z)</span>
    <span class="c">#@show z*z</span>
    <span class="k">while</span> <span class="x">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">max_steps</span><span class="x">)</span> <span class="o">&amp;&amp;</span> <span class="x">(</span><span class="n">real</span><span class="x">(</span><span class="n">z</span><span class="o">*</span><span class="n">conz</span><span class="x">)</span> <span class="o">&lt;</span> <span class="n">thresh</span><span class="x">)</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span><span class="n">c</span>
        
        <span class="n">i</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">end</span>
    <span class="c">#@show z    </span>
    <span class="k">return</span> <span class="n">i</span> 
<span class="k">end</span>
</code></pre></div></div>

<p>Okay now for the actual loop for to generate our image.</p>

<p>This could look a little complicated, but it is really simple. We do have to make use of some predefined equations though. We pass in the how big we want our initial matrix (n) and the maximum number of steps we want it to run for. The equations are</p>

\[mx = \frac{2.48}{n - 1} ; my = \frac{2.26}{n - 1}\]

<p>Now we define an empty matrix of size (n,n) and multiply it by 255. Since we want an image, 255 is the color black which will allow us to make a blank image.
Now for every point in the image (which is a matrix) we use a function to obtain its value.</p>

\[mapper(x,y) = (mx \cdot x - 2, my \cdot y - 1.13)\]

<p>We pass this obtained value to the function which we had defined to check if the number is diverging or not and for every point, return 255 - the obtained value.
We are almost done by now but I wanted to add something extra before we get to plotting it.</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> plotter</span><span class="x">(</span><span class="n">n</span> <span class="x">,</span> <span class="n">thresh</span><span class="x">,</span> <span class="n">max_steps</span><span class="o">=</span> <span class="mi">50</span><span class="x">,</span><span class="n">mxv</span> <span class="o">=</span> <span class="mf">2.48</span><span class="x">,</span> <span class="n">myv</span> <span class="o">=</span> <span class="mf">2.26</span><span class="x">)</span>
    <span class="n">mx</span> <span class="o">=</span> <span class="n">mxv</span><span class="o">/</span><span class="x">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="x">)</span>
    <span class="n">my</span> <span class="o">=</span> <span class="n">myv</span><span class="o">/</span><span class="x">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="x">)</span>
    <span class="n">mapper</span><span class="x">(</span><span class="n">x</span><span class="x">,</span><span class="n">y</span><span class="x">)</span> <span class="o">=</span> <span class="x">(</span><span class="n">mx</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="x">,</span> <span class="n">my</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mf">1.13</span><span class="x">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">ones</span><span class="x">(</span><span class="n">n</span><span class="x">,</span><span class="n">n</span><span class="x">)</span><span class="o">.*</span><span class="mi">255</span>
    <span class="k">for</span> <span class="n">x</span> <span class="k">in</span> <span class="n">collect</span><span class="x">(</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="x">)</span>
        <span class="k">for</span> <span class="n">y</span> <span class="k">in</span> <span class="n">collect</span><span class="x">(</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="x">)</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">mapper</span><span class="x">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="x">,</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="x">)</span>
            <span class="c">#@info temp</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">complex</span><span class="o">.</span><span class="x">(</span><span class="n">temp</span><span class="x">)</span>
            <span class="c">#@info temp</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">get_iter</span><span class="x">(</span><span class="n">temp</span><span class="x">,</span><span class="n">thresh</span><span class="x">,</span> <span class="n">max_steps</span><span class="x">)</span>
            <span class="c">#@show it</span>
            <span class="c">#@info x,y</span>
        <span class="k">end</span>
        <span class="c">#break</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">img</span>
<span class="k">end</span>
</code></pre></div></div>

<p>After this we have an output like this.</p>

<p><img src="/assets/img/frac2.png" alt="drawing" width="500" /></p>

<p>What if we wanted to add noise to the output?</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">prob</span> <span class="o">=</span> <span class="n">rand</span><span class="x">(</span><span class="mi">1</span><span class="x">)[</span><span class="mi">1</span><span class="x">]</span>
            <span class="k">if</span> <span class="n">prob</span><span class="o">&gt;.</span><span class="mi">5</span>
                <span class="n">img</span><span class="x">[</span><span class="n">y</span><span class="x">,</span><span class="n">x</span><span class="x">]</span> <span class="o">=</span> <span class="mi">255</span><span class="o">-</span> <span class="n">it</span>
            <span class="k">elseif</span> <span class="n">prob</span> <span class="o">&gt;.</span><span class="mi">8</span>
                <span class="n">img</span><span class="x">[</span><span class="n">y</span><span class="x">,</span><span class="n">x</span><span class="x">]</span> <span class="o">=</span> <span class="mi">155</span><span class="o">-</span> <span class="n">it</span>
            <span class="k">else</span>
                <span class="n">img</span><span class="x">[</span><span class="n">y</span><span class="x">,</span><span class="n">x</span><span class="x">]</span> <span class="o">=</span> <span class="mi">100</span><span class="o">-</span> <span class="n">it</span>
            <span class="k">end</span>
</code></pre></div></div>
<p>Let us just return different values at random points.</p>

<p>Okay now for the final bit.</p>

<p>Let us use a (1000, 1000) matrix with threshold 50 and max iterations 200.
We need to plot a heatmap. Of course, the colors are defined by the colormap which can be chosen as whatever looks the prettiest.</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fractal_img</span> <span class="o">=</span> <span class="n">plotter</span><span class="x">(</span><span class="mi">1000</span><span class="x">,</span><span class="mi">50</span><span class="x">,</span><span class="mi">200</span><span class="x">);</span>
<span class="n">heatmap</span><span class="x">(</span><span class="n">fractal_img</span><span class="x">,</span> <span class="n">fillcolor</span> <span class="o">=</span> <span class="o">:</span><span class="n">blues</span><span class="x">)</span>
</code></pre></div></div>

<h2 id="outputs">Outputs</h2>

<p>Aren’t these pretty??</p>

<p><img src="/assets/img/frac3.png" alt="drawing" width="500" /></p>

<p><img src="/assets/img/madel.png" alt="drawing" width="500" /></p>

<p><img src="/assets/img/madel2.png" alt="drawing" width="500" /></p>


<section>
Related posts:&emsp;

  <a href=/book/2021/03/09/AISuperpowersKaiFuLee.html> AI Superpowers Kai Fu Lee&emsp; </a>

  <a href=/book/2021/03/07/DigitalMinimalismCalNewport.html> Digital Minimalism Cal Newport&emsp; </a>

  <a href=/article/2021/03/05/tricksFromLectures.html> More Deep Learning, Less Crying - A guide&emsp; </a>

  <a href=/article/2020/10/09/SuperRes.html> Super resolution&emsp; </a>

  <a href=/article/2020/10/07/FederatedLearning.html> Federated Learning&emsp; </a>

  <a href=/article/2020/10/03/TakingBatchnormForGranted.html> Taking Batchnorm For Granted&emsp; </a>

  <a href=/article/2020/09/28/AdversarialAttack.html> A murder mystery and Adversarial attack&emsp; </a>

  <a href=/article/2020/09/26/An.html> Thank you and a rain check&emsp; </a>

  <a href=/article/2020/09/25/Pruning.html> Pruning&emsp; </a>

  <a href=/article/2020/09/04/Documentation.html> Documentation using Documenter.jl&emsp; </a>


</section>


    </div>
  </body>
</html>
